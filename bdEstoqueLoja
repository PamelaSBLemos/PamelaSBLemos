CREATE database bdEstoqueLoja;

USE bdEstoqueLoja;


CREATE TABLE CategoriasDeProdutos (
    ID INT PRIMARY KEY,        
    NomeDaCategoria VARCHAR(255)  
);

CREATE TABLE Fornecedores (
    ID INT PRIMARY KEY,         
    Nome VARCHAR(255),         
    Endereco VARCHAR(255),      
    Telefone VARCHAR(15)        
);

CREATE TABLE Produtos (
    ID INT PRIMARY KEY,         
    Nome VARCHAR(255),         
    Descricao TEXT,             
    Preco DECIMAL(10, 2),       
    QuantidadeEmEstoque INT,   
    Categoria INT,            
    Fornecedor INT,            
    FOREIGN KEY (Categoria) REFERENCES CategoriasDeProdutos(ID), 
    FOREIGN KEY (Fornecedor) REFERENCES Fornecedores(ID)         
);

CREATE TABLE Vendas (
    ID INT PRIMARY KEY,        
    DataDaVenda DATE,           
    ValorTotal DECIMAL(10, 2),  
    Funcionario VARCHAR(255)   
);

CREATE TABLE ItensDeVenda (
    ID INT PRIMARY KEY,         
    IDDoProduto INT,           
    IDDaVenda INT,           
    QuantidadeVendida INT,    
    PrecoUnitario DECIMAL(10, 2), 
    FOREIGN KEY (IDDoProduto) REFERENCES Produtos(ID),   
    FOREIGN KEY (IDDaVenda) REFERENCES Vendas(ID)     
);
    
    -- questao 01
select * from Produtos;

-- questao 02
select nome from Fornecedores;

-- questao 03
select * from CategoriasDeProdutos;

-- questao 04
select * from Produtos where Fornecedor = 2;

-- questao 05
select * from Produtos where Preco > 5;


-- questao 06
-- step 01
select * from Vendas inner join ItensDeVenda; 

-- step 02
select * from Vendas V inner join ItensDeVenda IV; 

-- step 03
select * from Vendas V inner join ItensDeVenda IV 
on V.ID = IV.IDDaVenda; 

-- step 04
select * from Vendas V inner join ItensDeVenda IV 
on V.ID = IV.IDDaVenda where IV.IDDoProduto = 2; 

-- questao 07
select SUM(QuantidadeEmEstoque * Preco) from Produtos;

-- questao 08
select Categoria, SUM(QuantidadeEmEstoque * Preco) from Produtos
group by Categoria;

-- questao 09
select * from Produtos where Categoria = 2;

-- questao 10
select * from Vendas where Funcionario = "Maria Santos";

-- questao 11
select * from ItensDeVenda iv
inner join Produtos p on iv.IDDoProduto = p.ID
where iv.IDDaVenda = 1; 

-- questao 12
-- desconsiderar, necessita de recursos mais avançados

-- questao 13
-- desconsiderar, necessita de recursos mais avançados

-- questao 14

-- step 01
SELECT * from fornecedores INNER JOIN produtos;

-- step 02
SELECT * from Fornecedores f INNER JOIN Produtos p;

-- step 03
SELECT * from Fornecedores f INNER JOIN Produtos p ON f.ID = p.Fornecedor;

-- step 04
SELECT * from Fornecedores f INNER JOIN Produtos p ON f.ID = p.Fornecedor GROUP BY f.ID;

-- step 05
SELECT * from Fornecedores f INNER JOIN Produtos p ON f.ID = p.Fornecedor GROUP BY f.ID
HAVING p.QuantidadeEmEstoque > 10;
